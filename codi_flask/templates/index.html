<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>패캠-데사스7B</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">


 	<link rel="stylesheet" href="static/css/preloader.css"/>
 
    <style media="screen">
        .container {
            margin-top: 40px;
            margin-bottom: 50px;
        } 

        .progress-adjust {
		    height: 10px;
		    margin-bottom: 0px; 
		} 
		.progress {
		    min-height:30px;
		}
		.p2{
			min-height:10px;
		}
 
		[id^=palette]:hover, #towpalette {
			cursor:pointer;
		}
    </style>
</head>
<body> 
 
<div class="container"> 
	<div class="page-header">
	<h1> Recomand Codination <small>,&nbsp;color palette </small></h1>
	</div>

	<table class='table' >
		<tr height="260px">
		<td style="width: 33%;text-align:center; ">
			<div style="display: inline-block;">
			<div style="font-size: 14px; margin-top: 27px; margin-bottom: 22px">selected color: 
				<b style="font-family: 'Courier New', monospace; " id="selectedHex">#1e88e5</b>
		    </div> 
		    <md-color-picker 
			    id="picker" 
			    value="#1e88e5" 
			    palette="material-full" 
			    color-margin="3"
			    colors-per-row="6" 
			    color-size="30"></md-color-picker>
			</div>
		</td>
		<td style="width:33%; vertical-align: middle; text-align: center;">
			<div class="progress progress-adjust" id='towpalette'>
				<div class="progress-bar progress-bar-success" id='color0' style="width: 50%; background-color: #000000">
				<div class="skill-div" id='color_rgb0'>#000000</div>   
				</div>
				<div class="progress-bar progress-bar-warning" id='color1' style="width: 50%;background-color: #00BCD4">
				<div class="skill-div" id='color_rgb1'>#00BCD4</div>  
				</div> 
			</div> 
			<p></p>
			<button type="button" class="btn btn-default" id="btn_getrect"> Recommand</button>
			 
 

		</td>
		<td style="width:33%; vertical-align: middle;">
			<div class="progress progress-adjust" id='palette0'>
				<div class="progress-bar progress-bar-success" id='rcolor00' style="width: 33.3%;background-color: #000000">
				<div class="skill-div" id='rcolor_rgb00'>#000000</div>   
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor01' style="width: 33.3%;background-color: #00BCD4">
				<div class="skill-div" id='rcolor_rgb01'>#00BCD4</div>  
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor02' style="width: 33.3%; background-color: #F2CD88 ">
				<div class="skill-div" id='rcolor_rgb02'>#F2CD88</div>  
				</div>
			</div>
			<br>
			<div class="progress progress-adjust" id='palette1'>
				<div class="progress-bar progress-bar-success" id='rcolor10' style="width: 33.3%;background-color: #000000">
				<div class="skill-div" id='rcolor_rgb10'>#000000</div>   
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor11' style="width: 33.3%;background-color: #00BCD4">
				<div class="skill-div" id='rcolor_rgb11'>#00BCD4</div>  
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor12' style="width: 33.3%;background-color: #EDEAEB">
				<div class="skill-div" id='rcolor_rgb12'>#EDEAEB</div>  
				</div>
			</div>
			<br>
			<div class="progress progress-adjust" id='palette2'>
				<div class="progress-bar progress-bar-success" id='rcolor20' style="width: 33.3%;background-color: #000000">
				<div class="skill-div" id='rcolor_rgb20'>#000000</div>   
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor21' style="width: 33.3%;background-color: #00BCD4">
				<div class="skill-div" id='rcolor_rgb21'>#00BCD4</div>  
				</div>
				<div class="progress-bar progress-bar-warning" id='rcolor22' style="width: 33.3%; background-color: #F6E159">
				<div class="skill-div" id='rcolor_rgb22'>#F6E159</div>  
				</div>
			</div>
		</td>
		</tr>
		<tr>
			<td colspan="3">
				<div class='row' id='codi_list'></div>
			</td>
		</tr>
	</table>   
</div> 
 
  


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="static/js/md-color-picker.js"></script>  
 
<script src="static/js/jquery.preloader.min.js"></script>
<script type="text/javascript">

    $(document).ready(function(){   
    	
    	var obj = {};
		var someBlock = $('#picker'); 
	    function start_loading(){ 

	    	someBlock.preloader({
	            text: obj.textVal,
	            percent: obj.percentVal,
	            duration: 200,
	        }); 
	    }
	    function stop_loading(){  
	    	someBlock.preloader('remove');  
	    }


    	var current_idx = 0;
		$('#picker').on('change', function(){
			var color = event.detail[0] 
			$('#picker').val(color);
			$('#selectedHex').text(color);
			  

 			// 0, 1 번갈아 가면서 컬러 설정하기위함
			if(current_idx==2){
				current_idx=0; 
			} 

			// 색상 세팅
			$('#color'+current_idx).css('background-color', color);
			$('#color_rgb'+current_idx).text(color.toUpperCase());

			// 컬러 모두 선택된 경우 추천해준다.
			if(current_idx==1){
				 
			} 
			current_idx++;

			// 1개 클릭
			get_codi(color, '#ffffff', '#ffffff', 1);
		}); // end of picker

		$('#btn_getrect').on('click', function(){
			var color0 = $('#color_rgb0').text();
			var color1 = $('#color_rgb1').text();
			
			var request = {
                color0:color0,
                color1:color1,
            };
				
				start_loading();
			$.post('/recommand/', request).done(function(data){
				console.log(data);
				for(var i=0; i<data.result.length; i++){ 
					r_color = data.result[i];

					$('#rcolor'+i + '0').css('background-color', color0);
					$('#rcolor'+i + '1').css('background-color', color1); 
					$('#rcolor'+i + '2').css('background-color', r_color);

					$('#rcolor_rgb'+i+'0').text(color0.toUpperCase());
					$('#rcolor_rgb'+i+'1').text(color1.toUpperCase()); 
					$('#rcolor_rgb'+i+'2').text(r_color.toUpperCase());

				}
		 		stop_loading();
			}); 
		})

		// 2개 클릭
		$('#towpalette').on('click', function(){
			c1 = $('#color_rgb0').text();
			c2 = $('#color_rgb1').text();  
  			c3 = '#000000';

			get_codi(c1, c2, c3, 2);
		});

		// 3개 클릭
		$('[id^=palette]').on('click', function(e){

			var pallette = $(this).attr('id'); 
			var i = pallette.substr(pallette.length - 1); // => "1"
			
			c1=$('#rcolor'+i + '0').css('background-color');
			c2=$('#rcolor'+i + '1').css('background-color'); 
			c3=$('#rcolor'+i + '2').css('background-color');
  

			c1 = $('#rcolor_rgb'+i + '0').text();
			c2 = $('#rcolor_rgb'+i + '1').text(); 
			c3 = $('#rcolor_rgb'+i + '2').text(); 
   
			get_codi(c1, c2, c3, 3); 
		});


		function get_codi(c1, c2, c3, cnt){ 
			 
			var request = {
                color1:c1,
                color2:c2,
                color3:c3,
                cnt:cnt,
            };

			$.post('/codi/', request).done(function(data){
            	if(data.status == 201){
            		console.log('errror');
            	}
            	else{ 

					$('#codi_list').empty();  
            		for(var i=0; i<data.result.length; i++){ 
            			row = data.result[i];
            			id_codi = row[0];
            			img = row[1];
            			gb = row[2]*100;
            			ratio = row[3];
            			rgb_data = row[4]; 
 
            			gb = gb.toFixed(2)

            			var rgb_tag =''; 
                        for(var j=0; j<ratio.length; j++){ 
                        	percenatge = ratio[j] * 100;
                        	rgbhex = rgb_data[j];

                        	rgb_tag += 
                        	'<div class="progress-bar progress-bar-success" style="width: '+percenatge+'%; background-color: '+rgbhex+';">'+
                        	'<div class="skill-div"></div></div>'; 
                        }

                        

            			var tag = 
                    	'<div class="col-sm-4 col-md-4"><div class="thumbnail" style="text-align:center;"><img src="'+
						img+
						'" data-holder-rendered="true" style="height: 200px;"><div class="caption"><h3 id="thumbnail-label">' +
						gb +
						'</h3></p><div class="progress progress-adjust">'+
						rgb_tag + 
						'</div></p></p></div></div></div>';
 
 
						$('#codi_list').append(tag);
            		}
            	}
            });
		} 
    });

     
</script>
</body>

</html>
